[
	{
		"label": ":docker: Resume Image",
		"key": "resume-image",
		"depends_on": "test-coverage",
		"plugins": [
			{
				"docker-login#v2.0.1": {
					"username": "_json_key",
					"password-env": "GOOGLE_APPLICATION_CREDENTIALS",
					"server": "https://gcr.io"
				}
			},
			{
				"docker-compose#v3.7.0": {
					"build": "resume",
					"no-cache": true,
					"image-repository": "gcr.io/smooth-verve-252121/resume",
					"push": "resume:gcr.io/smooth-verve-252121/resume:$BUILDKITE_COMMIT"
				}
			}
		]
	},
	{
		"label": ":docker: PDF Image",
		"key": "pdf-gen-image",
		"depends_on": "pdf-lint",
		"plugins": [
			{
				"docker-login#v2.0.1": {
					"username": "_json_key",
					"password-env": "GOOGLE_APPLICATION_CREDENTIALS",
					"server": "https://gcr.io"
				}
			},
			{
				"docker-compose#v3.7.0": {
					"build": "pdf-gen",
					"no-cache": true,
					"image-repository": "gcr.io/smooth-verve-252121/buildkite"
				}
			}
		]
	},
	{
		"label": ":docker: Deploy Image",
		"key": "deploy-image",
		"depends_on": "test-coverage",
		"plugins": [
			{
				"docker-login#v2.0.1": {
					"username": "_json_key",
					"password-env": "GOOGLE_APPLICATION_CREDENTIALS",
					"server": "https://gcr.io"
				}
			},
			{
				"docker-compose#v3.7.0": {
					"build": "deploy",
					"no-cache": true,
					"image-repository": "gcr.io/smooth-verve-252121/buildkite"
				}
			}
		]
	},
	{
		"label": ":k8s: Deploy",
		"key": "deploy",
		"depends_on": ["resume-image", "deploy-image"],
		"commands": ["bash deploy.sh deployment resume resume"],
		"plugins": [
			{
				"docker-login#v2.0.1": {
					"username": "_json_key",
					"password-env": "GOOGLE_APPLICATION_CREDENTIALS",
					"server": "https://gcr.io"
				}
			},
			{
				"docker-compose#v3.7.0": {
					"run": "deploy",
					"env": ["GOOGLE_APPLICATION_CREDENTIALS", "BUILDKITE_COMMIT"]
				}
			}
		]
	},
	{
		"label": ":gcloud: Upload PDF",
		"depends_on": ["pdf-gen-image", "deploy"],
		"commands": ["bash build-pdf.sh"],
		"plugins": [
			{
				"docker-login#v2.0.1": {
					"username": "_json_key",
					"password-env": "GOOGLE_APPLICATION_CREDENTIALS",
					"server": "https://gcr.io"
				}
			},
			{
				"docker-compose#v3.7.0": {
					"run": "pdf-gen",
					"env": ["GOOGLE_APPLICATION_CREDENTIALS"]
				}
			}
		]
	}
]
